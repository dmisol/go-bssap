Actually, this has nothing in common with BSSAP, but it looks covenient to keep it here
